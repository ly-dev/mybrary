<?php
/**
 * User type constant
 */
define("MYBRARY_USER_TYPE_DRUPAL", 0);
define("MYBRARY_USER_TYPE_FACEBOOK", 1);

/**
 * User relationship status constant
 */
define("MYBRARY_USER_RELATIONSHIP_STATUS_UNKNOWN", 0);
define("MYBRARY_USER_RELATIONSHIP_STATUS_CONFIRMED", 1);
define("MYBRARY_USER_RELATIONSHIP_STATUS_REJECTED", 2);

/**
 * Hook to manually save Facebook data after a user has connected.
 *
 * This hook is fired after a Drupal user account is created by the Facebook
 * OAuth module.
 *
 * @param $account
 *   A full Drupal user account object.
 * @param $fbuser
 *   The Facebook user account. Note that the contents of this object may change
 *   depending on what access the user has granted.
 * @return
 *   None.
 *
 * @see hook_fboauth_user_presave()
 */
function mybrary_user_fboauth_user_save($account, $fbuser) {
    
    // Save the Facebook user info into a custom table.
    $userData = array(
            'uid' => $account->uid,
            'type' => MYBRARY_USER_TYPE_FACEBOOK,
            'ext_id' => $fbuser->id,
            'ext_name' => $fbuser->name,
            'data' => NULL,
            'update_timestamp' => time(),
    );
    drupal_write_record('mybrary_user_ext', $userData);
    
    // Create the possible relationship
    
}